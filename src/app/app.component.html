<nav
  class="nav"
  [ngClass]="{ 'with-hero-bg': isAtTop }"
  [style.background-image]="isAtTop ? bannerBackground : ''"
>
  <div class="container nav-inner">
    <div class="brand">
      <img
        class="brand-logo"
        src="assets/images/id_photo.jpg"
        alt="Photo de profil"
        (click)="openAvatar()"
      />
      <span
        class="brand-full"
        role="link"
        tabindex="0"
        (click)="scrollToTop()"
        (keydown.enter)="scrollToTop()"
        >Mamadou Alpha <strong>DIALLO</strong></span
      >
      <span
        class="brand-compact"
        aria-label="MAD"
        role="link"
        tabindex="0"
        (click)="scrollToTop()"
        (keydown.enter)="scrollToTop()"
        >MAD</span
      >
    </div>
    <div class="links" role="navigation">
      <a href="#skills" [class.active]="activeSectionId === 'skills'">Compétences</a>
      <a href="#parcours" [class.active]="activeSectionId === 'parcours'">Parcours</a>
      <a href="#projects" [class.active]="activeSectionId === 'projects'">Projets</a>
      <a href="#about" [class.active]="activeSectionId === 'about'">Résumé</a>
      <a href="#contact" [class.active]="activeSectionId === 'contact'">Contact</a>
    </div>
    <span class="socials">
      <a
        *ngIf="linkedinHref"
        [href]="linkedinHref"
        target="_blank"
        rel="noopener"
        aria-label="LinkedIn"
        class="social-icon"
      >
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path
            fill="#0A66C2"
            d="M22.23 0H1.77C.79 0 0 .77 0 1.72v20.56C0 23.23.79 24 1.77 24h20.46c.98 0 1.77-.77 1.77-1.72V1.72C24 .77 23.21 0 22.23 0z"
          />
          <path
            fill="#fff"
            d="M6.56 20.45H3.11V9h3.45v11.45zM4.83 7.43a2.06 2.06 0 1 1 0-4.12 2.06 2.06 0 0 1 0 4.12zM20.45 20.45h-3.55v-5.57c0-1.33-.03-3.04-1.86-3.04-1.86 0-2.14 1.45-2.14 2.95v5.66H9.33V9h3.31v1.56h.05c.46-.9 1.62-1.85 3.35-1.85 3.6 0 4.27 2.37 4.27 5.46v6.28z"
          />
        </svg>
      </a>
      <a
        *ngIf="githubHref"
        [href]="githubHref"
        target="_blank"
        rel="noopener"
        aria-label="GitHub"
        class="social-icon"
      >
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path
            fill="#000"
            d="M12 .5a12 12 0 0 0-3.79 23.4c.6.11.82-.26.82-.58v-2.2c-3.34.73-4.04-1.61-4.04-1.61-.55-1.38-1.35-1.74-1.35-1.74-1.1-.74.08-.72.08-.72 1.22.08 1.86 1.25 1.86 1.25 1.08 1.84 2.84 1.31 3.53 1 .11-.77.42-1.31.76-1.61-2.66-.3-5.46-1.33-5.46-5.93 0-1.31.47-2.38 1.24-3.22-.12-.3-.54-1.52.12-3.17 0 0 1.01-.32 3.3 1.23a11.4 11.4 0 0 1 6 0c2.29-1.55 3.3-1.23 3.3-1.23.66 1.65.24 2.87.12 3.17.77.84 1.24 1.91 1.24 3.22 0 4.61-2.8 5.63-5.47 5.93.43.37.81 1.1.81 2.22v3.29c0 .32.22.7.83.58A12 12 0 0 0 12 .5z"
          />
        </svg>
      </a>
      <a
        *ngIf="gitlabHref"
        [href]="gitlabHref"
        target="_blank"
        rel="noopener"
        aria-label="GitLab"
        class="social-icon"
      >
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path
            fill="#FC6D26"
            d="M22.65 13.41l-1.32-4.06-1.32-4.06a.69.69 0 0 0-1.31 0l-1.32 4.06H6.62L5.3 5.29a.69.69 0 0 0-1.31 0L2.67 9.35l-1.32 4.06a.7.7 0 0 0 .26.79L12 22.5l10.39-8.3a.7.7 0 0 0 .26-.79z"
          />
        </svg>
      </a>
    </span>
    <div class="mobile-actions">
      <a
        *ngIf="linkedinHref"
        [href]="linkedinHref"
        target="_blank"
        rel="noopener"
        aria-label="LinkedIn"
        class="social-icon"
      >
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path
            fill="#0A66C2"
            d="M22.23 0H1.77C.79 0 0 .77 0 1.72v20.56C0 23.23.79 24 1.77 24h20.46c.98 0 1.77-.77 1.77-1.72V1.72C24 .77 23.21 0 22.23 0z"
          />
          <path
            fill="#fff"
            d="M6.56 20.45H3.11V9h3.45v11.45zM4.83 7.43a2.06 2.06 0 1 1 0-4.12 2.06 2.06 0 0 1 0 4.12zM20.45 20.45h-3.55v-5.57c0-1.33-.03-3.04-1.86-3.04-1.86 0-2.14 1.45-2.14 2.95v5.66H9.33V9h3.31v1.56h.05c.46-.9 1.62-1.85 3.35-1.85 3.6 0 4.27 2.37 4.27 5.46v6.28z"
          />
        </svg>
      </a>
      <a
        *ngIf="githubHref"
        [href]="githubHref"
        target="_blank"
        rel="noopener"
        aria-label="GitHub"
        class="social-icon"
      >
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path
            fill="#000"
            d="M12 .5a12 12 0 0 0-3.79 23.4c.6.11.82-.26.82-.58v-2.2c-3.34.73-4.04-1.61-4.04-1.61-.55-1.38-1.35-1.74-1.35-1.74-1.1-.74.08-.72.08-.72 1.22.08 1.86 1.25 1.86 1.25 1.08 1.84 2.84 1.31 3.53 1 .11-.77.42-1.31.76-1.61-2.66-.3-5.46-1.33-5.46-5.93 0-1.31.47-2.38 1.24-3.22-.12-.3-.54-1.52.12-3.17 0 0 1.01-.32 3.3 1.23a11.4 11.4 0 0 1 6 0c2.29-1.55 3.3-1.23 3.3-1.23.66 1.65.24 2.87.12 3.17.77.84 1.24 1.91 1.24 3.22 0 4.61-2.8 5.63-5.47 5.93.43.37.81 1.1.81 2.22v3.29c0 .32.22.7.83.58A12 12 0 0 0 12 .5z"
          />
        </svg>
      </a>
      <a
        *ngIf="gitlabHref"
        [href]="gitlabHref"
        target="_blank"
        rel="noopener"
        aria-label="GitLab"
        class="social-icon"
      >
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path
            fill="#FC6D26"
            d="M22.65 13.41l-1.32-4.06-1.32-4.06a.69.69 0 0 0-1.31 0l-1.32 4.06H6.62L5.3 5.29a.69.69 0 0 0-1.31 0L2.67 9.35l-1.32 4.06a.7.7 0 0 0 .26.79L12 22.5l10.39-8.3a.7.7 0 0 0 .26-.79z"
          />
        </svg>
      </a>
      <button class="hamburger" aria-label="Ouvrir le menu" (click)="toggleNav()">☰</button>
    </div>
  </div>
</nav>

<div class="drawer-overlay" *ngIf="isNavOpen" (click)="toggleNav()"></div>
<aside class="drawer" *ngIf="isNavOpen" role="dialog" aria-modal="true" aria-label="Navigation">
  <button class="close-btn" (click)="toggleNav()">Fermer ✕</button>
  <nav class="drawer-links">
    <a href="#skills" [class.active]="activeSectionId === 'skills'" (click)="toggleNav()"
      >Compétences</a
    >
    <a href="#parcours" [class.active]="activeSectionId === 'parcours'" (click)="toggleNav()"
      >Parcours</a
    >
    <a href="#projects" [class.active]="activeSectionId === 'projects'" (click)="toggleNav()"
      >Projets</a
    >
    <a href="#about" [class.active]="activeSectionId === 'about'" (click)="toggleNav()">Résumé</a>
    <a href="#contact" [class.active]="activeSectionId === 'contact'" (click)="toggleNav()"
      >Contact</a
    >
  </nav>
</aside>

<header class="hero">
  <div class="container hero-grid">
    <div class="hero-visual" aria-hidden="true" [style.background-image]="bannerBackground"></div>
    <div class="intro-panel">
      <div class="hero-content">
        <h1 class="hero-name" *ngIf="hero as h">
          <span>{{ h.titleLines[0] }}</span> <span>{{ h.titleLines[1] }}</span>
        </h1>
        <p class="hero-subtitle" *ngIf="hero as h">{{ h.subtitle }}</p>
        <div class="hero-meta" *ngIf="hero as h">
          <ng-container *ngFor="let m of h.meta; let last = last">
            <span>{{ m }}</span>
            <span class="dot" *ngIf="!last">•</span>
          </ng-container>
        </div>
        <p class="lead" *ngIf="hero as h">{{ h.lead }}</p>
        <div class="cta" *ngIf="hero?.cvHref">
          <a class="button" [href]="hero?.cvHref" download>⬇ Télécharger CV</a>
        </div>
      </div>
    </div>
  </div>
</header>

<section id="skills" class="section">
  <div class="container">
    <h2>Compétences</h2>
    <div class="softskills" *ngIf="softSkills.length">
      <span class="pill" *ngFor="let s of softSkills">{{ s }}</span>
    </div>
    <div class="grid cards">
      <div
        class="card"
        *ngFor="let group of skills; let i = index; trackBy: trackById"
        [hidden]="isSoftSkillsGroup(group)"
      >
        <h3 id="skill-{{ i }}">{{ group.title }}</h3>
        <div class="skills-list">
          <ng-container *ngFor="let item of group.items">
            <ng-container *ngIf="isSkillItem(item); else simpleLine">
              <div class="skill-row">
                <div class="skill-head">
                  <div class="skill-icon" [ngSwitch]="skillIconKey(item.label)">
                    <ng-container *ngIf="item.iconSvg; else iconSwitch">
                      <span [innerHTML]="item.iconSvg"></span>
                    </ng-container>
                    <ng-template #iconSwitch>
                      <svg *ngSwitchCase="'angular'" viewBox="0 0 24 24" aria-hidden="true">
                        <path
                          fill="#dd0031"
                          d="M12 1l9.5 3.5-1.7 14.6L12 23l-7.8-3.9L2.5 4.5 12 1z"
                        />
                        <path
                          fill="#fff"
                          d="M12 4.6l5.2 1.9-1.3 11.1L12 19.7l-3.9-2.1L6.8 6.5 12 4.6zm0 2.9L9.9 14h1.5l.4-1.3h2.3l.4 1.3H16L14 7.5h-4zm1 3.8l.7 2.2h-1.4l.7-2.2z"
                        />
                      </svg>
                      <svg *ngSwitchCase="'react'" viewBox="0 0 24 24" aria-hidden="true">
                        <path
                          fill="#61dafb"
                          d="M14.23 12c0 1.23-1 2.23-2.23 2.23S9.77 13.23 9.77 12s1-2.23 2.23-2.23S14.23 10.77 14.23 12z"
                        />
                        <path
                          fill="#61dafb"
                          d="M12 4.5c-1.3 0-2.6.1-3.8.4C6.7 5.2 5.3 5.7 4.3 6.4c-1 .7-1.7 1.5-2 2.3-.3.8-.3 1.7 0 2.5.3.8 1 1.6 2 2.3 1 .7 2.4 1.2 3.9 1.5 1.2.3 2.5.4 3.8.4s2.6-.1 3.8-.4c1.5-.3 2.9-.8 3.9-1.5s1.7-1.5 2-2.3c.3-.8.3-1.7 0-2.5-.3-.8-1-1.6-2-2.3s-2.4-1.2-3.9-1.5c-1.2-.3-2.5-.4-3.8-.4z"
                          fill-opacity="0"
                          stroke="#61dafb"
                        />
                      </svg>
                      <svg *ngSwitchCase="'typescript'" viewBox="0 0 24 24" aria-hidden="true">
                        <path fill="#3178c6" d="M3 3h18v18H3z" />
                        <path
                          fill="#fff"
                          d="M8 8h8v2h-3v6h-2v-6H8zM17.2 18c-.9 0-1.8-.4-2.3-1.1l1.2-1.2c.3.4.7.6 1.1.6.5 0 .8-.3.8-.7 0-.4-.3-.6-.9-.9l-.3-.1c-1-.4-1.7-1-1.7-2.1 0-1.1.8-1.9 2-1.9.9 0 1.6.3 2.1 1l-1.2 1.2c-.3-.3-.6-.4-.9-.4-.4 0-.7.3-.7.6 0 .4.3.6 1 .9l.3.1c1.2.5 1.8 1.1 1.8 2.2 0 1.3-1 2.1-2.3 2.1z"
                        />
                      </svg>
                      <svg *ngSwitchCase="'java'" viewBox="0 0 24 24" aria-hidden="true">
                        <path
                          fill="#ea2d2e"
                          d="M12 2s3.2 2 0 4c3.5-1 4-4 0-4zm-2 6s-2.4 1.2 0 2c2.6.8 6.4.4 8-1-2.4 0-4.7 0-8-1zm8 4c-1.8 1.4-7.2 1.8-10 1-2.8-.8-1-2 1-2 4 .2 8-.4 9 1z"
                        />
                      </svg>
                      <svg *ngSwitchCase="'python'" viewBox="0 0 24 24" aria-hidden="true">
                        <path fill="#3870a1" d="M12 2c5.5 0 5 3 5 3v4H7V5s-.5-3 5-3z" />
                        <path fill="#ffd43b" d="M12 22c-5.5 0-5-3-5-3v-4h10v4s.5 3-5 3z" />
                      </svg>
                      <svg *ngSwitchCase="'node'" viewBox="0 0 24 24" aria-hidden="true">
                        <path fill="#83cd29" d="M12 2l9 5v10l-9 5-9-5V7l9-5z" />
                      </svg>
                      <svg *ngSwitchCase="'docker'" viewBox="0 0 24 24" aria-hidden="true">
                        <path
                          fill="#0db7ed"
                          d="M3 12h18c0 4-3 7-8 7H7c-2 0-4-2-4-4v-3zM7 9h3v2H7V9zm4 0h3v2h-3V9zm4 0h3v2h-3V9z"
                        />
                      </svg>
                      <svg *ngSwitchDefault viewBox="0 0 24 24" aria-hidden="true">
                        <circle cx="12" cy="12" r="8" fill="#cbd5e1" />
                      </svg>
                    </ng-template>
                  </div>
                  <div class="skill-label">{{ item.label }}</div>
                  <div class="skill-percent">{{ item.level || 0 | number: '1.0-0' }}%</div>
                </div>
                <div class="skill-track">
                  <div class="skill-fill" [style.width.%]="item.level || 0"></div>
                </div>
              </div>
            </ng-container>
            <ng-template #simpleLine>
              <div class="skill-row">
                <div class="skill-head">
                  <div class="skill-icon">
                    <svg viewBox="0 0 24 24" aria-hidden="true">
                      <circle cx="12" cy="12" r="8" fill="#cbd5e1" />
                    </svg>
                  </div>
                  <div class="skill-label">{{ item }}</div>
                </div>
                <div class="skill-track">
                  <div class="skill-fill" style="width: 0%"></div>
                </div>
              </div>
            </ng-template>
          </ng-container>
        </div>
      </div>
    </div>
  </div>
</section>

<section id="parcours" class="section">
  <div class="container">
    <h2>Parcours</h2>
    <div class="timeline">
      <div
        class="tl-item reveal"
        *ngFor="let item of timelineItems; trackBy: trackById"
        [class.edu]="item.type === 'education'"
      >
        <div class="tl-dot"></div>
        <div class="tl-content">
          <div class="tl-title">
            <ng-container *ngIf="item.type === 'experience'; else eduTitle"
              >{{ item.title }} – {{ item.company }}</ng-container
            >
            <ng-template #eduTitle>{{ item.title }}</ng-template>
          </div>
          <div class="small">{{ item.period }} · {{ item.location }}</div>
          <ng-container *ngIf="item.type === 'experience'">
            <ul>
              <li *ngFor="let b of item.bullets">{{ b }}</li>
            </ul>
            <div class="kv" *ngIf="item.tech?.length">
              <span class="chip" *ngFor="let t of item.tech">{{ t }}</span>
            </div>
          </ng-container>
          <div class="cta" *ngIf="item.type === 'education' && item.refId">
            <button class="button secondary" (click)="openEducation(item.refId)">Détails</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section id="projects" class="section">
  <div class="container">
    <h2>Projets (sélection)</h2>
    <p class="lead">
      Un échantillon de projets académiques et techniques menés en équipe, avec rôles concrets et
      résultats.
    </p>
    <div class="grid cards">
      <div class="card" *ngFor="let p of featuredProjects; trackBy: trackById">
        <div class="badge">{{ p.year || 'Projet' }}</div>
        <h3>{{ p.name }}</h3>
        <p>{{ p.summary }}</p>
        <div class="kv">
          <span class="chip" *ngFor="let t of p.technologies">{{ t }}</span>
        </div>
        <div class="kv" *ngIf="p.grade">
          <span class="badge">Note : {{ p.grade }}</span>
        </div>
        <div class="cta" style="margin-top: 10px">
          <button class="button secondary" (click)="openProject(p.id)">Détails</button>
          <a
            class="button"
            *ngIf="p.links?.github"
            [href]="p.links?.github"
            target="_blank"
            rel="noopener"
            >Code</a
          >
          <a
            class="button"
            *ngIf="p.links?.demo"
            [href]="p.links?.demo"
            target="_blank"
            rel="noopener"
            >Démo</a
          >
        </div>
      </div>
    </div>
  </div>
</section>

<section id="about" class="section">
  <div class="container">
    <h2>{{ about?.title || 'Résumé' }}</h2>
    <ng-container *ngIf="about as a">
      <p class="lead" *ngFor="let p of a.paragraphs" [innerHTML]="p"></p>
    </ng-container>
  </div>
</section>

<section id="contact" class="section">
  <div class="container">
    <h2>Contact</h2>
    <p class="lead">
      Envie de collaborer ou de me recruter ? Écrivez‑moi directement ou consultez mes profils.
    </p>
    <div class="kv">
      <a
        class="chip inline contact-chip"
        *ngFor="let c of contacts"
        [href]="c.href"
        target="_blank"
        rel="noopener"
      >
        <ng-container [ngSwitch]="contactType(c)">
          <svg *ngSwitchCase="'email'" viewBox="0 0 24 24" class="chip-icon" aria-hidden="true">
            <path
              fill="#2563eb"
              d="M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2Zm0 4-8 5L4 8V6l8 5 8-5v2Z"
            />
          </svg>
          <svg *ngSwitchCase="'phone'" viewBox="0 0 24 24" class="chip-icon" aria-hidden="true">
            <path
              fill="#16a34a"
              d="M6.62 10.79a15.05 15.05 0 0 0 6.59 6.59l2.2-2.2a1 1 0 0 1 1.01-.24c1.1.37 2.28.57 3.58.57a1 1 0 0 1 1 1V20a1 1 0 0 1-1 1C10.07 21 3 13.93 3 5a1 1 0 0 1 1-1h3.49a1 1 0 0 1 1 1c0 1.3.2 2.48.57 3.58a1 1 0 0 1-.24 1.01l-2.2 2.2Z"
            />
          </svg>
          <svg *ngSwitchCase="'linkedin'" viewBox="0 0 24 24" class="chip-icon" aria-hidden="true">
            <path
              fill="#0A66C2"
              d="M22.23 0H1.77C.79 0 0 .77 0 1.72v20.56C0 23.23.79 24 1.77 24h20.46c.98 0 1.77-.77 1.77-1.72V1.72C24 .77 23.21 0 22.23 0z"
            />
            <path
              fill="#fff"
              d="M6.56 20.45H3.11V9h3.45v11.45zM4.83 7.43a2.06 2.06 0 1 1 0-4.12 2.06 2.06 0 0 1 0 4.12zM20.45 20.45h-3.55v-5.57c0-1.33-.03-3.04-1.86-3.04-1.86 0-2.14 1.45-2.14 2.95v5.66H9.33V9h3.31v1.56h.05c.46-.9 1.62-1.85 3.35-1.85 3.6 0 4.27 2.37 4.27 5.46v6.28z"
            />
          </svg>
          <svg *ngSwitchCase="'github'" viewBox="0 0 24 24" class="chip-icon" aria-hidden="true">
            <path
              fill="#000"
              d="M12 .5a12 12 0 0 0-3.79 23.4c.6.11.82-.26.82-.58v-2.2c-3.34.73-4.04-1.61-4.04-1.61-.55-1.38-1.35-1.74-1.35-1.74-1.1-.74.08-.72.08-.72 1.22.08 1.86 1.25 1.86 1.25 1.08 1.84 2.84 1.31 3.53 1 .11-.77.42-1.31.76-1.61-2.66-.3-5.46-1.33-5.46-5.93 0-1.31.47-2.38 1.24-3.22-.12-.3-.54-1.52.12-3.17 0 0 1.01-.32 3.3 1.23a11.4 11.4 0 0 1 6 0c2.29-1.55 3.3-1.23 3.3-1.23.66 1.65.24 2.87.12 3.17.77.84 1.24 1.91 1.24 3.22 0 4.61-2.8 5.63-5.47 5.93.43.37.81 1.1.81 2.22v3.29c0 .32.22.7.83.58A12 12 0 0 0 12 .5z"
            />
          </svg>
          <svg *ngSwitchCase="'gitlab'" viewBox="0 0 24 24" class="chip-icon" aria-hidden="true">
            <path
              fill="#FC6D26"
              d="M22.65 13.41l-1.32-4.06-1.32-4.06a.69.69 0 0 0-1.31 0l-1.32 4.06H6.62L5.3 5.29a.69.69 0 0 0-1.31 0L2.67 9.35l-1.32 4.06a.7.7 0 0 0 .26.79L12 22.5l10.39-8.3a.7.7 0 0 0 .26-.79z"
            />
          </svg>
          <svg *ngSwitchDefault viewBox="0 0 24 24" class="chip-icon" aria-hidden="true">
            <path
              fill="#64748b"
              d="M3 5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14l-4-4H5a2 2 0 0 1-2-2V5z"
            />
          </svg>
        </ng-container>
        <span>{{ c.label }}</span>
      </a>
    </div>
  </div>
</section>

<footer class="footer">
  <div class="container">© {{ currentYear }} · Portfolio de Mamadou Alpha Diallo</div>
</footer>

<button
  class="scrolltop"
  *ngIf="showScrollTop"
  (click)="scrollToTop()"
  aria-label="Remonter en haut"
>
  ↑
</button>

<app-avatar-modal *ngIf="showAvatarModal" (close)="closeAvatar()"></app-avatar-modal>

<app-education-modal
  *ngIf="selectedEducation as edu"
  [education]="edu"
  [projectNameById]="projectNameById.bind(this)"
  (openProjectRequested)="openProject($event)"
  (close)="selectedEducation = undefined"
></app-education-modal>

<app-project-modal
  *ngIf="selectedProject as proj"
  [project]="proj"
  (close)="selectedProject = undefined"
></app-project-modal>
